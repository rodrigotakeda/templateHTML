/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(e){function t(e){return"function"==typeof e}function n(e){return v(e)?"array":typeof e}function r(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}function o(e,t){return null!=e&&"object"!=typeof e&&e.hasOwnProperty&&e.hasOwnProperty(t)}function s(e,t){return w.call(e,t)}function a(e){return!s(y,e)}function u(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return x[e]})}function c(t,n){function i(e){if("string"==typeof e&&(e=e.split(k,2)),!v(e)||2!==e.length)throw new Error("Invalid tags: "+e)
o=new RegExp(r(e[0])+"\\s*"),s=new RegExp("\\s*"+r(e[1])),u=new RegExp("\\s*"+r("}"+e[1]))}if(!t)return[]
var o,s,u,c=[],f=[],d=[],g=!1,w=!1
i(n||e.tags)
for(var y,x,T,j,S,V,C=new h(t);!C.eos();){if(y=C.pos,T=C.scanUntil(o))for(var O=0,P=T.length;O<P;++O)j=T.charAt(O),a(j)?d.push(f.length):w=!0,f.push(["text",j,y,y+1]),y+=1,"\n"===j&&function(){if(g&&!w)for(;d.length;)delete f[d.pop()]
else d=[]
g=!1,w=!1}()
if(!C.scan(o))break
if(g=!0,x=C.scan(U)||"name",C.scan(b),"="===x?(T=C.scanUntil(m),C.scan(m),C.scanUntil(s)):"{"===x?(T=C.scanUntil(u),C.scan(E),C.scanUntil(s),x="&"):T=C.scanUntil(s),!C.scan(s))throw new Error("Unclosed tag at "+C.pos)
if(S=[x,T,y,C.pos],f.push(S),"#"===x||"^"===x)c.push(S)
else if("/"===x){if(!(V=c.pop()))throw new Error('Unopened section "'+T+'" at '+y)
if(V[1]!==T)throw new Error('Unclosed section "'+V[1]+'" at '+y)}else"name"===x||"{"===x||"&"===x?w=!0:"="===x&&i(T)}if(V=c.pop())throw new Error('Unclosed section "'+V[1]+'" at '+C.pos)
return l(p(f))}function p(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t))
return r}function l(e){for(var t,n,r=[],i=r,o=[],s=0,a=e.length;s<a;++s)switch(t=e[s],t[0]){case"#":case"^":i.push(t),o.push(t),i=t[4]=[]
break
case"/":n=o.pop(),n[5]=t[2],i=o.length>0?o[o.length-1][4]:r
break
default:i.push(t)}return r}function h(e){this.string=e,this.tail=e,this.pos=0}function f(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function d(){this.cache={}}var g=Object.prototype.toString,v=Array.isArray||function(e){return"[object Array]"===g.call(e)},w=RegExp.prototype.test,y=/\S/,x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},b=/\s*/,k=/\s+/,m=/\s*=/,E=/\s*\}/,U=/#|\^|\/|>|\{|&|=|!/
h.prototype.eos=function(){return""===this.tail},h.prototype.scan=function(e){var t=this.tail.match(e)
if(!t||0!==t.index)return""
var n=t[0]
return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},h.prototype.scanUntil=function(e){var t,n=this.tail.search(e)
switch(n){case-1:t=this.tail,this.tail=""
break
case 0:t=""
break
default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},f.prototype.push=function(e){return new f(e,this)},f.prototype.lookup=function(e){var n,r=this.cache
if(r.hasOwnProperty(e))n=r[e]
else{for(var s,a,u,c=this,p=!1;c;){if(e.indexOf(".")>0)for(s=c.view,a=e.split("."),u=0;null!=s&&u<a.length;)u===a.length-1&&(p=i(s,a[u])||o(s,a[u])),s=s[a[u++]]
else s=c.view[e],p=i(c.view,e)
if(p){n=s
break}c=c.parent}r[e]=n}return t(n)&&(n=n.call(this.view)),n},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(t,n){var r=this.cache,i=t+":"+(n||e.tags).join(":"),o=r[i]
return null==o&&(o=r[i]=c(t,n)),o},d.prototype.render=function(e,t,n,r){var i=this.parse(e,r),o=t instanceof f?t:new f(t)
return this.renderTokens(i,o,n,e)},d.prototype.renderTokens=function(e,t,n,r){for(var i,o,s,a="",u=0,c=e.length;u<c;++u)s=void 0,i=e[u],o=i[0],"#"===o?s=this.renderSection(i,t,n,r):"^"===o?s=this.renderInverted(i,t,n,r):">"===o?s=this.renderPartial(i,t,n,r):"&"===o?s=this.unescapedValue(i,t):"name"===o?s=this.escapedValue(i,t):"text"===o&&(s=this.rawValue(i)),void 0!==s&&(a+=s)
return a},d.prototype.renderSection=function(e,n,r,i){function o(e){return s.render(e,n,r)}var s=this,a="",u=n.lookup(e[1])
if(u){if(v(u))for(var c=0,p=u.length;c<p;++c)a+=this.renderTokens(e[4],n.push(u[c]),r,i)
else if("object"==typeof u||"string"==typeof u||"number"==typeof u)a+=this.renderTokens(e[4],n.push(u),r,i)
else if(t(u)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template")
u=u.call(n.view,i.slice(e[3],e[5]),o),null!=u&&(a+=u)}else a+=this.renderTokens(e[4],n,r,i)
return a}},d.prototype.renderInverted=function(e,t,n,r){var i=t.lookup(e[1])
if(!i||v(i)&&0===i.length)return this.renderTokens(e[4],t,n,r)},d.prototype.renderPartial=function(e,n,r){if(r){var i=t(r)?r(e[1]):r[e[1]]
return null!=i?this.renderTokens(this.parse(i),n,r,i):void 0}},d.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1])
if(null!=n)return n},d.prototype.escapedValue=function(t,n){var r=n.lookup(t[1])
if(null!=r)return e.escape(r)},d.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="3.0.0",e.tags=["{{","}}"]
var T=new d
return e.clearCache=function(){return T.clearCache()},e.parse=function(e,t){return T.parse(e,t)},e.render=function(e,t,r,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)')
return T.render(e,t,r,i)},e.to_html=function(n,r,i,o){var s=e.render(n,r,i)
if(!t(o))return s
o(s)},e.escape=u,e.Scanner=h,e.Context=f,e.Writer=d,e})
